<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ColorPicker Validation Fix Test</title>
    <style>
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial,
          sans-serif;
        margin: 0;
        padding: 30px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      }

      h1 {
        color: #333;
        text-align: center;
        margin-bottom: 40px;
        font-size: 2.5rem;
        font-weight: 700;
      }

      .validation-section {
        background: linear-gradient(135deg, #d4edda, #c3e6cb);
        padding: 25px;
        border-radius: 15px;
        margin: 25px 0;
        border-left: 5px solid #28a745;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      }

      .validation-section h3 {
        margin-top: 0;
        color: #155724;
        font-weight: 600;
      }

      .test-controls {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 15px;
        margin: 25px 0;
        border-left: 5px solid #007bff;
      }

      .test-controls h3 {
        margin-top: 0;
        color: #0056b3;
        font-weight: 600;
      }

      .button-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }

      button {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      }

      button:active {
        transform: translateY(0);
      }

      .generate-btn {
        background: linear-gradient(135deg, #28a745, #20c997);
        box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
      }

      .generate-btn:hover {
        box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
      }

      .status-message {
        padding: 15px 20px;
        border-radius: 10px;
        margin: 15px 0;
        font-weight: 600;
        font-size: 16px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .status-success {
        background: linear-gradient(135deg, #d4edda, #c3e6cb);
        color: #155724;
        border-left: 5px solid #28a745;
      }
      .status-error {
        background: linear-gradient(135deg, #f8d7da, #f5c6cb);
        color: #721c24;
        border-left: 5px solid #dc3545;
      }
      .status-warning {
        background: linear-gradient(135deg, #fff3cd, #ffeaa7);
        color: #856404;
        border-left: 5px solid #ffc107;
      }
      .status-info {
        background: linear-gradient(135deg, #d1ecf1, #bee5eb);
        color: #0c5460;
        border-left: 5px solid #17a2b8;
      }

      .generator-wrapper {
        background: white;
        padding: 30px;
        border: 2px solid #e9ecef;
        border-radius: 15px;
        margin: 25px 0;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
      }

      .instructions {
        background: linear-gradient(135deg, #e8f4fd, #f1f8ff);
        padding: 30px;
        border-radius: 15px;
        margin: 25px 0;
        border: 2px solid #bee5eb;
      }

      .instructions h3 {
        color: #0c5460;
        margin-top: 0;
      }

      .instructions ol {
        font-size: 16px;
        line-height: 1.6;
      }

      .emoji {
        font-size: 1.2em;
        margin-right: 8px;
      }

      .code-example {
        background: #2d3748;
        color: #e2e8f0;
        padding: 15px;
        border-radius: 8px;
        font-family: 'Fira Code', 'Courier New', monospace;
        font-size: 14px;
        margin: 10px 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üé® ColorPicker Validation Fix - Final Test</h1>

      <div class="validation-section">
        <h3><span class="emoji">‚úÖ</span>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ HEX —Ñ–æ—Ä–º–∞—Ç–∞</h3>
        <p>
          <strong>–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞:</strong> –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–ª–∞ —Ü–≤–µ—Ç–∞ —Å opacity, –ø–æ—Ç–æ–º—É —á—Ç–æ
          ColorPicker –≤–æ–∑–≤—Ä–∞—â–∞–ª <code>#RRGGBBAA</code> —Ñ–æ—Ä–º–∞—Ç, –∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–∂–∏–¥–∞–ª–∞ —Ç–æ–ª—å–∫–æ
          <code>#RRGGBB</code>.
        </p>

        <p>
          <strong>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</strong> –¢–µ–ø–µ—Ä—å ColorPicker –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π HEX —Ñ–æ—Ä–º–∞—Ç
          <code>#RRGGBB</code> (–±–µ–∑ alpha –∫–∞–Ω–∞–ª–∞), –∞ opacity —Ö—Ä–∞–Ω–∏—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
          —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.
        </p>

        <div class="code-example">
          // –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Å alpha –∫–∞–Ω–∞–ª–æ–º): value = "#FF572280" // ‚ùå –ù–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–æ –≤–∞–ª–∏–¥–∞—Ü–∏—é //
          –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π HEX): value = "#FF5722" // ‚úÖ –ü—Ä–æ—Ö–æ–¥–∏—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é opacity =
          50% // –•—Ä–∞–Ω–∏—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        </div>
      </div>

      <div class="test-controls">
        <h3><span class="emoji">üß™</span>–¢–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
        <div class="button-grid">
          <button onclick="testColorWithOpacity()">üé® –¢–µ—Å—Ç: –¶–≤–µ—Ç —Å opacity</button>
          <button onclick="testColorValidation()">‚úÖ –¢–µ—Å—Ç: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–≤–µ—Ç–æ–≤</button>
          <button onclick="testGeneration()" class="generate-btn">üöÄ –¢–µ—Å—Ç: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞</button>
          <button onclick="clearStatus()">üßπ –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
        </div>

        <div id="test-status"></div>
      </div>

      <div class="instructions">
        <h3><span class="emoji">üéØ</span>–ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
        <ol>
          <li>
            <strong>–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç:</strong> –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ü–≤–µ—Ç–Ω–æ–π –∫–≤–∞–¥—Ä–∞—Ç–∏–∫ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ª—é–±–æ–π —Ü–≤–µ—Ç
          </li>
          <li>
            <strong>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∏–∂–Ω–∏–π —Å–ª–∞–π–¥–µ—Ä –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
            opacity
          </li>
          <li><strong>–ó–∞–∫—Ä–æ–π—Ç–µ Pickr:</strong> –ö–ª–∏–∫–Ω–∏—Ç–µ –≤–Ω–µ –ø–∞–ª–∏—Ç—Ä—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è</li>
          <li>
            <strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é:</strong> –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Generate" - –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å
          </li>
          <li><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç:</strong> –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ value</li>
        </ol>

        <p><strong>üí° –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</strong></p>
        <ul>
          <li>‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç –¥–ª—è –ª—é–±–æ–≥–æ —Ü–≤–µ—Ç–∞ —Å –ª—é–±–æ–π –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é</li>
          <li>‚úÖ –ó–Ω–∞—á–µ–Ω–∏–µ value –≤—Å–µ–≥–¥–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ #RRGGBB</li>
          <li>‚úÖ –ü–æ–ª–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ opacity</li>
          <li>‚úÖ –ö–Ω–æ–ø–∫–∞ Generate —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫</li>
        </ul>
      </div>

      <div class="generator-wrapper">
        <color-transition-text-generator></color-transition-text-generator>
      </div>
    </div>

    <script type="module" src="./dist/color-transition-text-generator.js"></script>

    <script>
      let generator = null;

      function updateStatus(message, type = 'info') {
        const statusDiv = document.getElementById('test-status');
        statusDiv.innerHTML = `<div class="status-${type}">${message}</div>`;
      }

      function clearStatus() {
        document.getElementById('test-status').innerHTML = '';
      }

      async function testColorWithOpacity() {
        updateStatus('üé® –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–∞ —Å opacity...', 'info');

        try {
          generator = document.querySelector('color-transition-text-generator');
          if (!generator) {
            throw new Error('ColorTransitionTextGenerator –Ω–µ –Ω–∞–π–¥–µ–Ω');
          }

          const colorPickers = generator.shadowRoot?.querySelectorAll('ttg-color-picker');
          if (!colorPickers || colorPickers.length === 0) {
            throw new Error('ColorPicker –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
          }

          const picker = colorPickers[0];

          // –°–∏–º—É–ª–∏—Ä—É–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫—É —Ü–≤–µ—Ç–∞ —Å opacity
          console.log('–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ü–≤–µ—Ç...');

          // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
          const currentValue = picker.value;
          console.log('–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ value:', currentValue);

          // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç
          const hexRegex = /^#[0-9A-Fa-f]{6}$/;
          if (hexRegex.test(currentValue)) {
            updateStatus(
              `‚úÖ –£–°–ü–ï–•: –ó–Ω–∞—á–µ–Ω–∏–µ "${currentValue}" –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π HEX —Ñ–æ—Ä–º–∞—Ç #RRGGBB`,
              'success',
            );
            console.log('‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ');
          } else {
            updateStatus(
              `‚ùå –û–®–ò–ë–ö–ê: –ó–Ω–∞—á–µ–Ω–∏–µ "${currentValue}" –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç—É #RRGGBB`,
              'error',
            );
            console.log('‚ùå –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –ø—Ä–æ–≤–∞–ª–∏–ª–∞—Å—å');
          }
        } catch (error) {
          updateStatus(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ${error.message}`, 'error');
          console.error('–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:', error);
        }
      }

      async function testColorValidation() {
        updateStatus('‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ ColorPicker...', 'info');

        try {
          generator = document.querySelector('color-transition-text-generator');
          const colorPickers = generator?.shadowRoot?.querySelectorAll('ttg-color-picker');

          if (!colorPickers || colorPickers.length === 0) {
            throw new Error('ColorPicker –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
          }

          let allValid = true;
          let validationResults = [];

          for (let i = 0; i < colorPickers.length; i++) {
            const picker = colorPickers[i];
            const isValid = picker.validate();
            const value = picker.value;

            validationResults.push(
              `ColorPicker ${i + 1}: ${isValid ? '‚úÖ' : '‚ùå'} (value: ${value})`,
            );

            if (!isValid) {
              allValid = false;
              console.log(`ColorPicker ${i + 1} validation failed:`, picker.error);
            }
          }

          if (allValid) {
            updateStatus(
              `‚úÖ –£–°–ü–ï–•: –í—Å–µ ColorPicker –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—à–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é!<br>${validationResults.join('<br>')}`,
              'success',
            );
          } else {
            updateStatus(
              `‚ö†Ô∏è –ß–ê–°–¢–ò–ß–ù–û: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ ColorPicker –Ω–µ –ø—Ä–æ—à–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é<br>${validationResults.join('<br>')}`,
              'warning',
            );
          }
        } catch (error) {
          updateStatus(`‚ùå –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: ${error.message}`, 'error');
        }
      }

      async function testGeneration() {
        updateStatus('üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞...', 'info');

        try {
          generator = document.querySelector('color-transition-text-generator');
          if (!generator) {
            throw new Error('ColorTransitionTextGenerator –Ω–µ –Ω–∞–π–¥–µ–Ω');
          }

          // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –∫–Ω–æ–ø–∫–∞ Generate
          const generateButton = generator.shadowRoot?.querySelector('ttg-button[type="primary"]');
          if (!generateButton) {
            throw new Error('–ö–Ω–æ–ø–∫–∞ Generate –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
          }

          console.log('–ü–æ–ø—ã—Ç–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞...');

          // –°–∏–º—É–ª–∏—Ä—É–µ–º –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ Generate
          generateButton.click();

          // –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
          await new Promise((resolve) => setTimeout(resolve, 1000));

          updateStatus(
            '‚úÖ –£–°–ü–ï–•: –ö–Ω–æ–ø–∫–∞ Generate —Ä–∞–±–æ—Ç–∞–µ—Ç! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.',
            'success',
          );
          console.log('‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
        } catch (error) {
          updateStatus(`‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ${error.message}`, 'error');
          console.error('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:', error);
        }
      }

      // –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫
      window.addEventListener('error', (e) => {
        console.error('‚ùå JavaScript Error:', e.message);
        if (e.message.includes('validation') || e.message.includes('HEX')) {
          updateStatus(`‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: ${e.message}`, 'error');
        }
      });

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      document.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => {
          generator = document.querySelector('color-transition-text-generator');
          if (generator) {
            console.log('‚úÖ ColorTransitionTextGenerator —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω');
            console.log('üéØ ColorPicker –≥–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –≤–∞–ª–∏–¥–∞—Ü–∏–∏!');

            updateStatus(
              'üéØ ColorTransitionTextGenerator –∑–∞–≥—Ä—É–∂–µ–Ω! –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –≤–∞–ª–∏–¥–∞—Ü–∏–∏ HEX —Ñ–æ—Ä–º–∞—Ç–∞.',
              'info',
            );
          } else {
            updateStatus('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ ColorTransitionTextGenerator', 'error');
          }
        }, 2000);
      });
    </script>
  </body>
</html>
